import{d as le,r as v,a as Q,i as b,w as a,x as ze,e as s,b as t,c as h,y as F,F as L,j as f,g as _,h as r,o as c,E as M,_ as oe,z as K,A as Re,t as k,B as me,C as pe,D as te,G as ae,H as Ue,I as Se,J as Ae,K as Pe,L as Ge,v as Be,M as Me,N as Ye,f as Ee,O as ue,P as qe,Q as Fe,R as Le,S as ee,T as Oe,U as je,V as Xe,W as Ke,X as We,q as He}from"./index-BwQo0H46.js";import{T as Je,I as Qe,g as ne,c as Ze,P as fe,a as et,b as ce,u as tt,d as at,e as lt}from"./treatment-CO7JOLCe.js";import"./request-Kr2qLYJT.js";const ot=le({__name:"TreatmentCreateDialog",props:{defaultPatient:{}},emits:["success"],setup(Z,{expose:B,emit:D}){const z=Z,y=D,$=v(!1),C=v(!1),T=v(),R=v(null),Y=Je,A=v(!1),p=v([]),m=v(!1),g=Q({patient:"",patientName:"",target:"",sequence_number:void 0,duration:.5}),x={patient:[{required:!0,message:"è¯·é€‰æ‹©å…³è”æ‚£è€…",trigger:"change"}],target:[{required:!0,message:"è¯·é€‰æ‹©æ²»ç–—éƒ¨ä½",trigger:"change"}]},W=N=>{g.patient="",g.patientName="",g.target="face",g.sequence_number=void 0,g.duration=.5,p.value=[];const l=N||z.defaultPatient;l?(m.value=!0,g.patient=l.documentId,g.patientName=l.Name):m.value=!1,$.value=!0,ze(()=>{T.value?.clearValidate()})},H=async N=>{if(N&&!m.value){A.value=!0;try{const l=await ne({"filters[Name][$contains]":N,"pagination[limit]":10});p.value=l.data?.data||l.data||[]}catch(l){console.error(l)}finally{A.value=!1}}},U=async()=>{T.value&&await T.value.validate(async N=>{if(N){C.value=!0;try{let l=[];R.value&&(l=await R.value.submitAll());const n={patient:g.patient,target:g.target,sequence_number:g.sequence_number,duration:g.duration,Images:l};console.log("ğŸ“¡ æ–°å»ºæ²»ç–— Payload:",n),await Ze(n),M.success("æ²»ç–—è®°å½•åˆ›å»ºæˆåŠŸ"),$.value=!1,y("success")}catch(l){console.error(l);const n=l.response?.data?.error?.message||"åˆ›å»ºå¤±è´¥ï¼Œè¯·é‡è¯•";M.error(n)}finally{C.value=!1}}})};return B({open:W}),(N,l)=>{const n=s("User"),w=s("el-icon"),S=s("el-input"),I=s("el-option"),O=s("el-select"),G=s("el-form-item"),j=s("el-col"),E=s("el-input-number"),J=s("el-row"),i=s("el-form"),e=s("el-button"),u=s("el-dialog");return c(),b(u,{modelValue:$.value,"onUpdate:modelValue":l[5]||(l[5]=d=>$.value=d),title:"æ–°å»ºæ²»ç–—è®°å½•",width:"600px","close-on-click-modal":!1,"destroy-on-close":"","append-to-body":""},{footer:a(()=>[t(e,{onClick:l[4]||(l[4]=d=>$.value=!1)},{default:a(()=>[...l[8]||(l[8]=[_("å–æ¶ˆ",-1)])]),_:1}),t(e,{type:"primary",loading:C.value,onClick:U},{default:a(()=>[...l[9]||(l[9]=[_("ç¡®å®šåˆ›å»º",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(i,{ref_key:"formRef",ref:T,model:g,rules:x,"label-width":"100px","label-position":"right"},{default:a(()=>[t(G,{label:"å…³è”æ‚£è€…",prop:"patient"},{default:a(()=>[m.value?(c(),b(S,{key:0,"model-value":g.patientName,disabled:"",placeholder:"å·²é”å®šå½“å‰æ‚£è€…"},{prefix:a(()=>[t(w,null,{default:a(()=>[t(n)]),_:1})]),_:1},8,["model-value"])):(c(),b(O,{key:1,modelValue:g.patient,"onUpdate:modelValue":l[0]||(l[0]=d=>g.patient=d),filterable:"",remote:"","reserve-keyword":"",placeholder:"è¯·è¾“å…¥æ‚£è€…å§“åæœç´¢","remote-method":H,loading:A.value,style:{width:"100%"}},{default:a(()=>[(c(!0),h(L,null,F(p.value,d=>(c(),b(I,{key:d.documentId,label:`${d.Name} (${d.Gender==="male"?"ç”·":"å¥³"})`,value:d.documentId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]))]),_:1}),t(J,{gutter:20},{default:a(()=>[t(j,{span:12},{default:a(()=>[t(G,{label:"æ²»ç–—éƒ¨ä½",prop:"target"},{default:a(()=>[t(O,{modelValue:g.target,"onUpdate:modelValue":l[1]||(l[1]=d=>g.target=d),placeholder:"è¯·é€‰æ‹©",style:{width:"100%"}},{default:a(()=>[(c(!0),h(L,null,F(f(Y),d=>(c(),b(I,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(j,{span:12},{default:a(()=>[t(G,{label:"æ²»ç–—æ—¶é•¿",prop:"duration"},{default:a(()=>[t(E,{modelValue:g.duration,"onUpdate:modelValue":l[2]||(l[2]=d=>g.duration=d),min:0,step:.5,"controls-position":"right",style:{width:"100%"}},{suffix:a(()=>[...l[6]||(l[6]=[_("å°æ—¶",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(G,{label:"æ²»ç–—å½±åƒ"},{default:a(()=>[t(Qe,{ref_key:"uploaderRef",ref:R,limit:9},null,512)]),_:1}),t(G,{label:"æ‰‹åŠ¨åºå·",prop:"sequence_number"},{default:a(()=>[t(E,{modelValue:g.sequence_number,"onUpdate:modelValue":l[3]||(l[3]=d=>g.sequence_number=d),min:1,placeholder:"ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ",style:{width:"100%"}},null,8,["modelValue"]),l[7]||(l[7]=r("div",{class:"tips"},"é€šå¸¸æ— éœ€å¡«å†™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—æ˜¯ç¬¬å‡ æ¬¡æ²»ç–—ã€‚",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),_e=oe(ot,[["__scopeId","data-v-ad372f26"]]),nt={class:"dialog-header"},st=["id"],rt={class:"header-actions"},dt={key:0,class:"loading-state"},it={key:1,class:"detail-container"},ut={class:"patient-header-card"},ct={class:"header-left"},mt={class:"patient-name"},pt={class:"patient-meta"},ft={class:"header-right"},_t={key:0,class:"history-box"},gt={class:"value"},vt={class:"timeline-list"},yt={class:"collapse-header-content"},bt={class:"header-main"},ht={class:"treatment-no"},xt={class:"date-text ml-2",style:{"margin-left":"20px"}},kt={class:"collapse-body"},wt=["onTouchend"],Vt={class:"image-error"},Ct={key:0,class:"carousel-tip"},Nt=le({__name:"PatientDetailDialog",setup(Z,{expose:B}){const D=v(!1),z=v(!1),y=v(null),$=v([0]),C=v(),T=v({}),R=v(""),Y=(l,n)=>{l&&(T.value[Number(n)]=l)},A=l=>l?new Date().getFullYear()-new Date(l).getFullYear():"?",p=l=>l?l.startsWith("http")?l:"http://192.168.1.111:1337"+l:"";let m=0,g=0;const x=l=>{l.touches&&l.touches.length>0&&(m=l.touches[0].clientX,g=l.touches[0].clientY)},W=(l,n)=>{if(!l.changedTouches||l.changedTouches.length===0)return;const w=m-l.changedTouches[0].clientX,S=g-l.changedTouches[0].clientY;if(Math.abs(w)>50&&Math.abs(w)>Math.abs(S)){const I=T.value[Number(n)];I&&(w>0?I.next():I.prev())}},H=()=>{y.value&&C.value.open({documentId:y.value.documentId,Name:y.value.Name})},U=()=>{R.value&&N(R.value)},N=async l=>{D.value=!0,z.value=!0,y.value=null,$.value=[0],T.value={},R.value=l;try{const n=await ne({filters:{documentId:{$eq:l}},populate:{treatments:{populate:"Images",sort:"createdAt:desc"}}});let w=null;if(n.data&&n.data.data&&Array.isArray(n.data.data)?w=n.data.data[0]:n.data&&Array.isArray(n.data)&&(w=n.data[0]),w)y.value=w;else throw new Error("æœªæ‰¾åˆ°æ•°æ®")}catch(n){console.error("è·å–è¯¦æƒ…å¤±è´¥:",n),M.error("æ•°æ®åŒæ­¥å¤±è´¥")}finally{z.value=!1}};return B({open:N}),(l,n)=>{const w=s("el-button"),S=s("el-icon"),I=s("el-tag"),O=s("el-image"),G=s("el-carousel-item"),j=s("el-carousel"),E=s("el-empty"),J=s("el-collapse-item"),i=s("el-collapse"),e=s("el-dialog");return c(),b(e,{modelValue:D.value,"onUpdate:modelValue":n[2]||(n[2]=u=>D.value=u),width:"90%",style:{"max-width":"650px"},"align-center":"","destroy-on-close":"","append-to-body":"","show-close":!1,class:"custom-dialog fixed-header-dialog"},{header:a(({titleId:u,titleClass:d})=>[r("div",nt,[r("span",{id:u,class:te([d,"header-title"])},k(z.value?"æ•°æ®åŒæ­¥ä¸­...":"æ‚£è€…è¯¦ç»†æ¡£æ¡ˆ"),11,st),r("div",rt,[t(w,{type:"primary",icon:f(ae),disabled:z.value||!y.value,onClick:H,round:"",size:"default"},{default:a(()=>[...n[3]||(n[3]=[_(" æ–°å»ºæ²»ç–—è®°å½• ",-1)])]),_:1},8,["icon","disabled"]),t(w,{circle:"",icon:f(Ue),onClick:n[0]||(n[0]=V=>D.value=!1),style:{border:"none",background:"#f3f4f6"}},null,8,["icon"])])])]),default:a(()=>[z.value?(c(),h("div",dt,[t(S,{class:"is-loading"},{default:a(()=>[t(f(Re))]),_:1}),n[4]||(n[4]=r("p",null,"æ­£åœ¨è·å–å®Œæ•´ç—…å†...",-1))])):y.value?(c(),h("div",it,[r("div",ut,[r("div",ct,[r("h2",mt,[_(k(y.value.Name)+" ",1),t(S,{class:te(y.value.Gender==="male"?"icon-male":"icon-female")},{default:a(()=>[y.value.Gender==="male"?(c(),b(f(me),{key:0})):(c(),b(f(pe),{key:1}))]),_:1},8,["class"])]),r("p",pt,k(A(y.value.Birthday))+" å² | "+k(y.value.Birthday),1)]),r("div",ft,[t(I,{size:"large",type:"success",effect:"dark",round:""},{default:a(()=>[_(" å…± "+k(y.value.treatments?.length||0)+" æ¬¡ ",1)]),_:1})])]),y.value.past_treatments?.length?(c(),h("div",_t,[n[5]||(n[5]=r("span",{class:"label"},"æ—¢å¾€æ²»ç–—ï¼š",-1)),r("span",gt,k(y.value.past_treatments.map(u=>f(fe)[u]||u).join("ã€")),1)])):K("",!0),n[8]||(n[8]=r("div",{class:"timeline-divider"},"æ²»ç–—è®°å½•",-1)),r("div",vt,[t(i,{modelValue:$.value,"onUpdate:modelValue":n[1]||(n[1]=u=>$.value=u),class:"custom-collapse"},{default:a(()=>[(c(!0),h(L,null,F(y.value.treatments,(u,d)=>(c(),b(J,{key:u.documentId||d,name:d,class:"custom-collapse-item"},{title:a(()=>[r("div",yt,[r("div",bt,[r("span",ht,k(u.treatmentNo),1),t(I,{size:"large",effect:"plain",class:"ml-2"},{default:a(()=>[_(k(f(et)[u.target]||u.target),1)]),_:2},1024),u.duration?(c(),b(I,{key:0,type:"info",size:"large",effect:"plain",class:"ml-2",style:{display:"flex","align-items":"center",border:"1px solid #f3f4f6"}},{default:a(()=>[t(S,{style:{"margin-right":"4px"}},{default:a(()=>[t(f(Pe))]),_:1}),_(" "+k(u.duration)+" å°æ—¶ ",1)]),_:2},1024)):K("",!0),r("span",xt,k(new Date(u.createdAt).toLocaleDateString()),1)])])]),default:a(()=>[r("div",kt,[u.Images&&u.Images.length>0?(c(),h("div",{key:0,class:"image-wrapper",onTouchstart:x,onTouchend:V=>W(V,d)},[t(j,{ref_for:!0,ref:V=>Y(V,d),autoplay:!1,trigger:"click","indicator-position":"outside",height:"250px",arrow:"always"},{default:a(()=>[(c(!0),h(L,null,F(u.Images,(V,P)=>(c(),b(G,{key:V.documentId||V.url},{default:a(()=>[t(O,{src:p(V.url),fit:"scale-down",class:"carousel-image","preview-src-list":u.Images.map(q=>p(q.url)),"preview-teleported":"","hide-on-click-modal":"","initial-index":P},{error:a(()=>[r("div",Vt,[t(S,{size:"24"},{default:a(()=>[t(f(Se))]),_:1}),n[6]||(n[6]=r("span",{class:"mt-2 text-xs"},"æ— æ³•åŠ è½½å½±åƒ",-1))])]),_:1},8,["src","preview-src-list","initial-index"])]),_:2},1024))),128))]),_:2},1536),u.Images.length>1?(c(),h("div",Ct,[t(S,null,{default:a(()=>[t(f(Ae))]),_:1}),n[7]||(n[7]=_(" å¯å·¦å³æ»‘åŠ¨åˆ‡æ¢ï¼Œç‚¹å‡»å¯æŸ¥çœ‹å¤§å›¾ ",-1))])):K("",!0)],40,wt)):(c(),b(E,{key:1,description:"æœ¬æ¬¡æœªä¸Šä¼ å½±åƒ","image-size":50,class:"mini-empty"}))])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),y.value.treatments?.length?K("",!0):(c(),b(E,{key:1,description:"æš‚æ— æ²»ç–—è®°å½•"})),n[9]||(n[9]=r("div",{style:{height:"20px"}},null,-1))])):K("",!0),t(_e,{ref_key:"treatmentCreateRef",ref:C,onSuccess:U},null,512)]),_:1},8,["modelValue"])}}}),$t=oe(Nt,[["__scopeId","data-v-50a1ca94"]]),Tt={class:"app-container"},It={class:"header-actions mb-6"},Dt={class:"search-box"},zt={class:"flex gap-2"},Rt={class:"card-grid-container"},Ut={class:"card-header p-4 flex justify-between items-center bg-gray-50 border-b relative"},St={class:"flex items-center gap-2"},At={class:"text-lg font-bold text-gray-800 truncate"},Pt={class:"el-dropdown-link p-2 -mr-2 text-gray-400 hover:text-gray-600"},Gt={class:"card-body p-4"},Bt={class:"info-row text-gray-500 text-sm mb-3 flex items-center gap-2"},Mt={class:"ml-1 text-gray-400"},Yt={class:"info-row text-gray-500 text-xs mb-3 flex items-start gap-2 bg-gray-50 p-2 rounded"},Et={class:"flex-1"},qt={key:0},Ft={key:1,class:"text-gray-300"},Lt={class:"flex justify-between items-center mt-4"},Ot={key:0,class:"flex items-center gap-1"},jt={key:1,class:"text-xs text-gray-300"},Xt={class:"pagination-container mt-8 flex justify-center"},Kt={class:"dialog-footer"},Wt=le({__name:"index",setup(Z){const B=v(!1),D=v([]),z=v(0),y=v(),$=v(),C=v(!1),T=v("æ–°å»ºæ‚£è€…"),R=v(!1),Y=v(),A=v(!1),p=Q({Name:"",Gender:"",birthdayRange:[],past_treatments:[]}),m=Q({documentId:void 0,Name:"",Gender:"male",Birthday:"",past_treatments:["none"]}),g={Name:[{required:!0,message:"è¯·è¾“å…¥å§“å",trigger:"blur"}],Birthday:[{required:!0,message:"è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ",trigger:"change"}]},x=Q({page:1,pageSize:12,keyword:""}),W=v(window.innerWidth<=768),H=i=>{if(!i)return"?";const e=new Date(i),u=new Date;let d=u.getFullYear()-e.getFullYear();const V=u.getMonth()-e.getMonth();return(V<0||V===0&&u.getDate()<e.getDate())&&d--,d},U=async()=>{B.value=!0;try{const i={},e=p.Name||x.keyword;e&&(i.$or=[{Name:{$containsi:e}}]),p.Gender&&(i.Gender={$eq:p.Gender}),p.birthdayRange&&p.birthdayRange.length===2&&(i.Birthday={$gte:p.birthdayRange[0],$lte:p.birthdayRange[1]}),p.past_treatments&&p.past_treatments.length>0&&(i.past_treatments={$contains:p.past_treatments});const u={page:x.page,pageSize:x.pageSize,filters:i,populate:{treatments:{fields:["treatmentNo","createdAt"]}}},d=await ne(u);d.data&&d.data.data?(D.value=d.data.data,z.value=d.data.meta?.pagination?.total||0):d.data&&(D.value=d.data,z.value=d.meta?.pagination?.total||0)}catch(i){console.error("è·å–åˆ—è¡¨å¤±è´¥:",i)}finally{B.value=!1}},N=()=>{x.page=1,A.value=!1,U()},l=()=>{p.Name="",p.Gender="",p.birthdayRange=[],p.past_treatments=[],N()},n=()=>{x.page=1,U()},w=i=>{x.page=i,U()},S=i=>{i.documentId&&He.confirm(`ç¡®å®šåˆ é™¤æ‚£è€… "${i.Name}" å—ï¼Ÿ`,"è­¦å‘Š",{confirmButtonText:"åˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(async()=>{try{await lt(i.documentId),M.success("åˆ é™¤æˆåŠŸ"),U()}catch{M.error("åˆ é™¤å¤±è´¥")}})},I=()=>{T.value="æ–°å»ºæ‚£è€…",m.documentId=void 0,m.Name="",m.Gender="male",m.Birthday="",m.past_treatments=["none"],C.value=!0},O=i=>{T.value="ç¼–è¾‘æ‚£è€…",m.documentId=i.documentId,m.Name=i.Name,m.Gender=i.Gender,m.Birthday=i.Birthday,m.past_treatments=Array.isArray(i.past_treatments)?i.past_treatments:[],C.value=!0},G=async()=>{Y.value&&await Y.value.validate(async i=>{if(i){R.value=!0;try{m.documentId?(await tt(m.documentId,{...m}),M.success("ä¿®æ”¹æˆåŠŸ")):(await at({...m}),M.success("åˆ›å»ºæˆåŠŸ")),C.value=!1,U()}catch{M.error("æ“ä½œå¤±è´¥")}finally{R.value=!1}}})};Ge(()=>m.past_treatments,(i,e)=>{i.length>1&&(i.includes("none")&&e.includes("none")?m.past_treatments=i.filter(u=>u!=="none"):i.includes("none")&&!e.includes("none")&&(m.past_treatments=["none"])),i.length===0&&(m.past_treatments=["none"])},{deep:!0});const j=i=>{i&&y.value?.open(i)},E=i=>{$.value.open({documentId:i.documentId,Name:i.Name})},J=()=>{U()};return Be(()=>{U()}),(i,e)=>{const u=s("el-button"),d=s("el-icon"),V=s("el-input"),P=s("el-form-item"),q=s("el-radio-button"),se=s("el-radio-group"),re=s("el-date-picker"),ge=s("el-option"),ve=s("el-select"),de=s("el-form"),ye=s("el-drawer"),be=s("el-empty"),ie=s("el-dropdown-item"),he=s("el-dropdown-menu"),xe=s("el-dropdown"),ke=s("el-tag"),we=s("el-card"),Ve=s("el-col"),Ce=s("el-row"),Ne=s("el-pagination"),$e=s("el-checkbox"),Te=s("el-checkbox-group"),Ie=s("el-dialog"),De=qe("loading");return c(),h("div",Tt,[r("div",It,[r("div",Dt,[t(u,{size:"large",icon:f(Ye),onClick:e[0]||(e[0]=o=>A.value=!0)},{default:a(()=>[...e[17]||(e[17]=[_("é«˜çº§æœç´¢",-1)])]),_:1},8,["icon"]),t(V,{modelValue:x.keyword,"onUpdate:modelValue":e[1]||(e[1]=o=>x.keyword=o),placeholder:"è¾“å…¥å…³é”®è¯è¿›è¡Œå¤šå­—æ®µæœç´¢...",size:"large",clearable:"",onClear:n,onKeyup:Ee(n,["enter"])},{prefix:a(()=>[t(d,null,{default:a(()=>[t(f(ue))]),_:1})]),_:1},8,["modelValue"]),t(u,{type:"primary",icon:f(ue),size:"large",onClick:n},{default:a(()=>[...e[18]||(e[18]=[_("æœç´¢",-1)])]),_:1},8,["icon"])]),t(u,{type:"success",icon:f(ae),size:"large",onClick:I,class:"create-btn"},{default:a(()=>[...e[19]||(e[19]=[_("æ–°å»ºæ‚£è€…",-1)])]),_:1},8,["icon"])]),t(ye,{modelValue:A.value,"onUpdate:modelValue":e[6]||(e[6]=o=>A.value=o),title:"ğŸ” é«˜çº§æœç´¢",size:W.value?"100%":"380px","destroy-on-close":""},{footer:a(()=>[r("div",zt,[t(u,{class:"flex-1",icon:f(Fe),onClick:l},{default:a(()=>[...e[23]||(e[23]=[_("é‡ç½®",-1)])]),_:1},8,["icon"]),t(u,{class:"flex-1",type:"primary",icon:f(Le),onClick:N},{default:a(()=>[...e[24]||(e[24]=[_("æœç´¢",-1)])]),_:1},8,["icon"])])]),default:a(()=>[t(de,{model:p,"label-position":"top",class:"p-2"},{default:a(()=>[t(P,{label:"æ‚£è€…å§“å"},{default:a(()=>[t(V,{modelValue:p.Name,"onUpdate:modelValue":e[2]||(e[2]=o=>p.Name=o),placeholder:"æ¨¡ç³Šæœç´¢",size:"large",clearable:""},null,8,["modelValue"])]),_:1}),t(P,{label:"æ€§åˆ«"},{default:a(()=>[t(se,{modelValue:p.Gender,"onUpdate:modelValue":e[3]||(e[3]=o=>p.Gender=o),class:"w-full"},{default:a(()=>[t(q,{label:""},{default:a(()=>[...e[20]||(e[20]=[_("å…¨éƒ¨",-1)])]),_:1}),t(q,{label:"male"},{default:a(()=>[...e[21]||(e[21]=[_("ç”·",-1)])]),_:1}),t(q,{label:"female"},{default:a(()=>[...e[22]||(e[22]=[_("å¥³",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(P,{label:"å‡ºç”Ÿæ—¥æœŸ"},{default:a(()=>[t(re,{modelValue:p.birthdayRange,"onUpdate:modelValue":e[4]||(e[4]=o=>p.birthdayRange=o),type:"daterange","value-format":"YYYY-MM-DD",class:"w-full"},null,8,["modelValue"])]),_:1}),t(P,{label:"æ—¢å¾€æ²»ç–—"},{default:a(()=>[t(ve,{modelValue:p.past_treatments,"onUpdate:modelValue":e[5]||(e[5]=o=>p.past_treatments=o),multiple:"","collapse-tags":"",class:"w-full"},{default:a(()=>[(c(!0),h(L,null,F(f(ce),o=>(c(),b(ge,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","size"]),Me((c(),h("div",Rt,[!B.value&&D.value.length===0?(c(),b(be,{key:0,description:"æš‚æ— æ‚£è€…æ•°æ®"})):K("",!0),t(Ce,{gutter:20},{default:a(()=>[(c(!0),h(L,null,F(D.value,o=>(c(),b(Ve,{key:o.documentId,xs:24,sm:12,md:8,lg:6,class:"mb-4"},{default:a(()=>[t(we,{class:"patient-card cursor-pointer hover:shadow-lg transition-all",shadow:"hover","body-style":{padding:"0px"},onClick:X=>j(o.documentId)},{default:a(()=>[r("div",Ut,[r("div",St,[r("span",At,k(o.Name),1),t(d,{class:te([o.Gender==="male"?"text-blue-500":"text-pink-500","text-lg"])},{default:a(()=>[o.Gender==="male"?(c(),b(f(me),{key:0})):(c(),b(f(pe),{key:1}))]),_:2},1032,["class"])]),r("div",{onClick:e[7]||(e[7]=ee(()=>{},["stop"]))},[t(xe,{trigger:"click"},{dropdown:a(()=>[t(he,null,{default:a(()=>[t(ie,{icon:f(je),onClick:X=>O(o)},{default:a(()=>[...e[25]||(e[25]=[_(" ç¼–è¾‘æ¡£æ¡ˆ ",-1)])]),_:1},8,["icon","onClick"]),t(ie,{icon:f(Xe),class:"text-danger",divided:"",onClick:X=>S(o)},{default:a(()=>[...e[26]||(e[26]=[_(" åˆ é™¤æ‚£è€… ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),default:a(()=>[r("span",Pt,[t(d,{class:"text-lg transform rotate-90"},{default:a(()=>[t(f(Oe))]),_:1})])]),_:2},1024)])]),r("div",Gt,[r("div",Bt,[t(d,null,{default:a(()=>[t(f(Ke))]),_:1}),r("span",null,[_(k(o.Birthday)+" ",1),r("span",Mt,"("+k(H(o.Birthday))+"å²)",1)])]),r("div",Yt,[t(d,{class:"mt-0.5"},{default:a(()=>[t(f(We))]),_:1}),r("div",Et,[e[27]||(e[27]=r("span",{class:"font-bold"},"æ—¢å¾€æ²»ç–—: ",-1)),o.past_treatments?.length?(c(),h("span",qt,k(o.past_treatments.map(X=>f(fe)[X]||X).join("ã€")),1)):(c(),h("span",Ft,"æ— "))])]),r("div",Lt,[e[30]||(e[30]=r("span",{class:"text-xs text-gray-400"},"æ²»ç–—è®°å½•",-1)),o.treatments?.length?(c(),h("div",Ot,[t(ke,{size:"small",type:"success",round:""},{default:a(()=>[_("å…± "+k(o.treatments.length)+" æ¬¡",1)]),_:2},1024),e[28]||(e[28]=r("span",{class:"text-xs text-gray-300"},"|",-1)),e[29]||(e[29]=r("span",{class:"text-xs text-blue-500 font-bold"},"æŸ¥çœ‹è¯¦æƒ… >",-1))])):(c(),h("span",jt,"æš‚æ— è®°å½•"))])]),r("div",{class:"card-footer px-4 py-3 border-t bg-white",onClick:e[8]||(e[8]=ee(()=>{},["stop"]))},[t(u,{class:"w-full",type:"primary",icon:f(ae),round:"",plain:"",onClick:ee(X=>E(o),["stop"])},{default:a(()=>[...e[31]||(e[31]=[_(" æ–°å»ºæ²»ç–—è®°å½• ",-1)])]),_:1},8,["icon","onClick"])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])),[[De,B.value]]),r("div",Xt,[t(Ne,{"current-page":x.page,"onUpdate:currentPage":e[9]||(e[9]=o=>x.page=o),"page-size":x.pageSize,"onUpdate:pageSize":e[10]||(e[10]=o=>x.pageSize=o),total:z.value,layout:"prev, pager, next",background:"","pager-count":5,onCurrentChange:w},null,8,["current-page","page-size","total"])]),t(Ie,{modelValue:C.value,"onUpdate:modelValue":e[16]||(e[16]=o=>C.value=o),title:T.value,width:"90%",style:{"max-width":"500px"},"close-on-click-modal":!1,"append-to-body":""},{footer:a(()=>[r("span",Kt,[t(u,{size:"large",onClick:e[15]||(e[15]=o=>C.value=!1)},{default:a(()=>[...e[34]||(e[34]=[_("å–æ¶ˆ",-1)])]),_:1}),t(u,{size:"large",type:"primary",loading:R.value,onClick:G},{default:a(()=>[...e[35]||(e[35]=[_("ä¿å­˜",-1)])]),_:1},8,["loading"])])]),default:a(()=>[t(de,{ref_key:"formRef",ref:Y,model:m,rules:g,"label-width":"70px","label-position":"top"},{default:a(()=>[t(P,{label:"å§“å",prop:"Name"},{default:a(()=>[t(V,{modelValue:m.Name,"onUpdate:modelValue":e[11]||(e[11]=o=>m.Name=o),size:"large"},null,8,["modelValue"])]),_:1}),t(P,{label:"æ€§åˆ«",prop:"Gender"},{default:a(()=>[t(se,{modelValue:m.Gender,"onUpdate:modelValue":e[12]||(e[12]=o=>m.Gender=o),size:"large",class:"w-full"},{default:a(()=>[t(q,{label:"male",class:"w-1/2"},{default:a(()=>[...e[32]||(e[32]=[_("ç”·",-1)])]),_:1}),t(q,{label:"female",class:"w-1/2"},{default:a(()=>[...e[33]||(e[33]=[_("å¥³",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(P,{label:"å‡ºç”Ÿæ—¥æœŸ",prop:"Birthday"},{default:a(()=>[t(re,{modelValue:m.Birthday,"onUpdate:modelValue":e[13]||(e[13]=o=>m.Birthday=o),type:"date",style:{width:"100%"},size:"large","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(P,{label:"æœ‰æ— æ¥å—è¿‡å…¶ä»–æ²»ç–—"},{default:a(()=>[t(Te,{modelValue:m.past_treatments,"onUpdate:modelValue":e[14]||(e[14]=o=>m.past_treatments=o)},{default:a(()=>[(c(!0),h(L,null,F(f(ce),o=>(c(),b($e,{key:o.value,label:o.value,border:"",class:"mb-2 mr-2 ml-0"},{default:a(()=>[_(k(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t($t,{ref_key:"patientDetailRef",ref:y},null,512),t(_e,{ref_key:"treatmentCreateRef",ref:$,onSuccess:J},null,512)])}}}),Zt=oe(Wt,[["__scopeId","data-v-75efb47e"]]);export{Zt as default};
